// <!--GAMFC--> version base on commit 1ac053b8237d74f8dff68f7d80b77ad106c42d72, time is 2025-10-02 16:04:12 UTC<!--We are all REvil-->
// @ts-ignore

import{connect}from'cloudflare:sockets';const Config={'defaultProxyIPs':['nima.nscl.ir:443'],'defaultDoHUpstream':'https://chrome.cloudflare-dns.com/dns-query','scamalytics':{'username':'revilseptember','apiKey':'b2fc368184deb3d8ac914bd776b8215fe899dd8fef69fbaba77511acfbdeca0d','baseUrl':'https://api12.scamalytics.com/v3/'},'fromEnv'(a){const b=a['PROXYIP']?a['PROXYIP']['split'](',')['map'](f=>f['trim']()):this['defaultProxyIPs'],c=b[Math['floor'](Math['random']()*b['length'])],[d,e='443']=c['split'](':');return{'proxyAddress':c,'proxyIP':d,'proxyPort':parseInt(e,0xa),'dohUpstreamUrl':a['DOH_UPSTREAM_URL']||this['defaultDoHUpstream'],'scamalytics':{'username':a['SCAMALYTICS_USERNAME']||this['scamalytics']['username'],'apiKey':a['SCAMALYTICS_API_KEY']||this['scamalytics']['apiKey'],'baseUrl':a['SCAMALYTICS_BASEURL']||this['scamalytics']['baseUrl']}};}},CONST={'WS_READY_STATE_OPEN':0x1,'WS_READY_STATE_CLOSING':0x2,'DNS_PORT':0x35};export default{async 'fetch'(a,b,c){try{const d=new URL(a['url']),e=Config['fromEnv'](b);if(a['headers']['get']('Upgrade')?.['toLowerCase']()==='websocket')return handleWebSocket(a,b,c);if(d['pathname']==='/dns-query'&&(a['method']==='POST'||a['method']==='GET'))return handleDnsQuery(a,e['dohUpstreamUrl']);if(d['pathname']==='/api/network-info')return handleNetworkInfo(a,e);if(!b['DB']||!b['KV'])return new Response('Service\x20Unavailable:\x20D1\x20or\x20KV\x20binding\x20is\x20not\x20configured.',{'status':0x1f7});!b['ADMIN_KEY']&&console['error']('CRITICAL:\x20ADMIN_KEY\x20secret\x20is\x20not\x20set\x20in\x20environment\x20variables.');if(d['pathname']['startsWith']('/admin'))return handleAdminRoutes(a,b);const f=d['pathname']['slice'](0x1)['split']('/');let g;if((f[0x0]==='xray'||f[0x0]==='sb')&&f['length']>0x1){g=f[0x1];if(await isValidUser(g,b,c))return handleIpSubscription(f[0x0],g,d['hostname']);}else f['length']===0x1&&isValidUUID(f[0x0])&&(g=f[0x0]);if(g&&await isValidUser(g,b,c))return handleConfigPage(g,d['hostname'],e['proxyAddress']);return new Response('404\x20Not\x20Found.\x20Please\x20use\x20your\x20unique\x20user\x20ID\x20in\x20the\x20URL.',{'status':0x194});}catch(h){return console['error']('Unhandled\x20Exception\x20in\x20fetch\x20handler:',h),new Response('Internal\x20Server\x20Error',{'status':0x1f4});}}};async function handleWebSocket(a,b,c){const d=new WebSocketPair(),[e,f]=Object['values'](d);f['accept']();const g=(m,n)=>console['log']('[WS]\x20'+m,n||''),h=a['headers']['get']('Sec-WebSocket-Protocol')||'',i=makeReadableWebSocketStream(f,h,g);let j={'value':null},k=![];const l=Config['fromEnv'](b);return i['pipeTo'](new WritableStream({async 'write'(m,n){if(k&&j['value']){const z=j['value']['writable']['getWriter']();try{await z['write'](m);}finally{z['releaseLock']();}return;}const {hasError:o,message:p,addressRemote:q,portRemote:r,rawDataIndex:s,version:t,isUDP:u,requestHeader:v}=await processVlessHeader(m,b,c);if(o)return g('VLESS\x20Header\x20Error:\x20'+p),n['error'](new Error(p));const w=m['slice'](s),x='['+q+':'+r+']';if(u){if(r===CONST['DNS_PORT'])return DOH_resolver(w,f,l['dohUpstreamUrl'],v,x);console['log'](x+'\x20Generic\x20UDP\x20traffic\x20is\x20not\x20supported.\x20Dropping\x20packet.');return;}const y=await handleTCPOutbound({'addressRemote':q,'portRemote':r,'vlessResponseHeader':new Uint8Array([t,0x0]),'initialClientData':w,'webSocket':f,'log':(A,B)=>console['log'](x+'\x20'+A,B||'')});if(!y)return n['error'](new Error('Failed\x20to\x20establish\x20remote\x20TCP\x20connection.'));j['value']=y,k=!![],y['readable']['pipeTo'](new WritableStream({'write'(A){if(f['readyState']===CONST['WS_READY_STATE_OPEN'])f['send'](A);},'close':()=>console['log'](x+'\x20Remote\x20socket\x20readable\x20stream\x20closed.'),'abort':A=>console['log'](x+'\x20Remote\x20socket\x20readable\x20stream\x20aborted:',A)}))['catch'](A=>console['log'](x+'\x20Error\x20piping\x20remote\x20to\x20WebSocket:',A));},'abort':m=>g('WebSocket\x20readable\x20stream\x20aborted:',m)}))['catch'](m=>{g('WebSocket\x20pipeline\x20failed:',m),safeCloseWebSocket(f);}),new Response(null,{'status':0x65,'webSocket':e});}async function handleTCPOutbound({addressRemote:a,portRemote:b,vlessResponseHeader:c,initialClientData:d,webSocket:e,log:f}){try{f('Connecting\x20to\x20destination...');const g=await connect({'hostname':a,'port':b});f('Connection\x20successful.');e['readyState']===CONST['WS_READY_STATE_OPEN']&&e['send'](c);const h=g['writable']['getWriter']();return await h['write'](d),h['releaseLock'](),g;}catch(i){return f('Connection\x20to\x20'+a+':'+b+'\x20failed',i),safeCloseWebSocket(e,0x3f3,'Proxy\x20connection\x20failed:\x20'+i['message']),null;}}async function DOH_resolver(a,b,c,d,e){try{const f=await fetch(c,{'method':'POST','headers':{'Content-Type':'application/dns-message','Accept':'application/dns-message'},'body':a});if(!f['ok']){console['error'](e+'\x20DoH\x20request\x20failed\x20with\x20status:',f['status']);return;}const g=await f['arrayBuffer'](),h=new Uint8Array(d['length']+g['byteLength']);h['set'](d),h['set'](new Uint8Array(g),d['length']),b['readyState']===CONST['WS_READY_STATE_OPEN']&&b['send'](h);}catch(i){console['error'](e+'\x20DoH\x20resolver\x20failed:',i);}}async function processVlessHeader(a,b,c){if(a['byteLength']<0x18)return{'hasError':!![],'message':'Invalid\x20VLESS\x20header'};const d=new DataView(a),e=d['getUint8'](0x0),f=stringify(new Uint8Array(a['slice'](0x1,0x11)));if(!await isValidUser(f,b,c))return{'hasError':!![],'message':'Invalid\x20user'};const g=d['getUint8'](0x11),h=d['getUint8'](0x12+g),i=0x12+g+0x1,j=d['getUint16'](i),k=d['getUint8'](i+0x2);let l,m;switch(k){case 0x1:l=new Uint8Array(a['slice'](i+0x3,i+0x7))['join']('.'),m=i+0x7;break;case 0x2:const n=d['getUint8'](i+0x3);l=new TextDecoder()['decode'](a['slice'](i+0x4,i+0x4+n)),m=i+0x4+n;break;case 0x3:const o=Array['from']({'length':0x8},(p,q)=>d['getUint16'](i+0x3+q*0x2)['toString'](0x10))['join'](':');l='['+o+']',m=i+0x13;break;default:return{'hasError':!![],'message':'Invalid\x20addressType:\x20'+k};}return{'hasError':![],'addressRemote':l,'portRemote':j,'rawDataIndex':m,'version':e,'isUDP':h===0x2,'requestHeader':a['slice'](0x0,m)};}async function handleDnsQuery(a,b){const c=new URL(a['url']),d=new URL(b);d['search']=c['search'];const f=new Request(d,{'method':a['method'],'headers':{'Content-Type':'application/dns-message','Accept':'application/dns-message','User-Agent':a['headers']['get']('User-Agent')||'Cloudflare-Worker-DoH-Proxy'},'body':a['method']==='POST'?a['body']:null});try{const g=await fetch(f);return new Response(g['body'],g);}catch(h){return console['error']('DoH\x20proxy\x20failed:',h),new Response('DNS\x20query\x20proxy\x20failed',{'status':0x1f6});}}async function handleNetworkInfo(a,b){const c=a['headers']['get']('CF-Connecting-IP'),d=b['proxyIP'],e=async k=>{if(!k)return null;try{const l=await fetch('https://ipinfo.io/'+k+'/json');if(!l['ok'])throw new Error('ipinfo.io\x20status:\x20'+l['status']);return await l['json']();}catch(m){return console['error']('Failed\x20to\x20fetch\x20details\x20for\x20IP\x20'+k+':',m),{'ip':k};}},f=async k=>{if(!k||!b['scamalytics']['apiKey']||!b['scamalytics']['username'])return null;try{const l=''+b['scamalytics']['baseUrl']+b['scamalytics']['username']+'/?key='+b['scamalytics']['apiKey']+'&ip='+k,m=await fetch(l);if(!m['ok'])throw new Error('Scamalytics\x20status:\x20'+m['status']);const n=await m['json']();return n['status']==='ok'?{'score':n['score'],'risk':n['risk']}:null;}catch(o){return console['error']('Failed\x20to\x20fetch\x20Scamalytics\x20for\x20IP\x20'+k+':',o),null;}},[g,h,i]=await Promise['all']([e(c),e(d),f(c)]),j={'client':{...g,'isp':g['org'],'risk':i},'proxy':{'host':b['proxyAddress'],...h,'isp':h['org']}};return new Response(JSON['stringify'](j),{'headers':{'Content-Type':'application/json','Access-Control-Allow-Origin':'*'}});}const isValidUUID=a=>/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i['test'](a);async function isValidUser(a,b,c){if(!isValidUUID(a))return![];const d='user:'+a,f=await b['KV']['get'](d);if(f==='valid')return!![];if(f==='invalid')return![];try{const g=Math['floor'](Date['now']()/0x3e8),h=b['DB']['prepare']('SELECT\x20expiration_timestamp,\x20status\x20FROM\x20users\x20WHERE\x20id\x20=\x20?'),i=await h['bind'](a)['first']();if(!i||i['expiration_timestamp']<g||i['status']!=='active')return await b['KV']['put'](d,'invalid',{'expirationTtl':0xe10}),![];return c['waitUntil'](b['DB']['prepare']('UPDATE\x20users\x20SET\x20last_accessed\x20=\x20?\x20WHERE\x20id\x20=\x20?')['bind'](g,a)['run']()),await b['KV']['put'](d,'valid',{'expiration':i['expiration_timestamp']}),!![];}catch(j){return console['error']('D1\x20query\x20failed\x20in\x20isValidUser:',j),![];}}function makeReadableWebSocketStream(a,b,c){let d=![];return new ReadableStream({'start'(e){a['addEventListener']('message',h=>{if(d)return;e['enqueue'](h['data']);}),a['addEventListener']('close',()=>{if(d)return;e['close']();}),a['addEventListener']('error',h=>{if(d)return;c('WebSocket\x20error',h),e['error'](h);});const {earlyData:f,error:g}=base64ToArrayBuffer(b);if(g)e['error'](g);else f&&e['enqueue'](f);},'pull'(){},'cancel'(e){c('ReadableStream\x20cancelled',e),d=!![],safeCloseWebSocket(a);}});}function safeCloseWebSocket(a,b,c){try{(a['readyState']===CONST['WS_READY_STATE_OPEN']||a['readyState']===CONST['WS_READY_STATE_CLOSING'])&&a['close'](b,c);}catch(d){console['error']('safeCloseWebSocket\x20error:',d);}}const byteToHex=Array['from']({'length':0x100},(a,b)=>(b+0x100)['toString'](0x10)['slice'](0x1));function stringify(a){const b=(byteToHex[a[0x0]]+byteToHex[a[0x1]]+byteToHex[a[0x2]]+byteToHex[a[0x3]]+'-'+byteToHex[a[0x4]]+byteToHex[a[0x5]]+'-'+byteToHex[a[0x6]]+byteToHex[a[0x7]]+'-'+byteToHex[a[0x8]]+byteToHex[a[0x9]]+'-'+byteToHex[a[0xa]]+byteToHex[a[0xb]]+byteToHex[a[0xc]]+byteToHex[a[0xd]]+byteToHex[a[0xe]]+byteToHex[a[0xf]])['toLowerCase']();if(!isValidUUID(b))throw new TypeError('Invalid\x20UUID');return b;}function base64ToArrayBuffer(a){if(!a)return{'earlyData':null,'error':null};try{const b=atob(a['replace'](/-/g,'+')['replace'](/_/g,'/')),c=new ArrayBuffer(b['length']),d=new Uint8Array(c);for(let e=0x0;e<b['length'];e++)d[e]=b['charCodeAt'](e);return{'earlyData':c,'error':null};}catch(f){return{'earlyData':null,'error':f};}}function generateRandomPath(a=0xc,b=''){const c='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';let d='';for(let e=0x0;e<a;e++){d+=c['charAt'](Math['floor'](Math['random']()*c['length']));}return'/'+d+(b?'?'+b:'');}const CORE_PRESETS={'xray':{'tls':{'path':()=>generateRandomPath(0xc,'ed=2048'),'security':'tls','fp':'chrome','alpn':'http/1.1','extra':{}},'tcp':{'path':()=>generateRandomPath(0xc,'ed=2048'),'security':'none','fp':'chrome','extra':{}}},'sb':{'tls':{'path':()=>generateRandomPath(0x12),'security':'tls','fp':'firefox','alpn':'h3','extra':{'ed':0xa00}},'tcp':{'path':()=>generateRandomPath(0x12),'security':'none','fp':'firefox','extra':{'ed':0xa00}}}};function makeName(a,b){return a+'-'+b['toUpperCase']();}function createVlessLink({userID:a,address:b,port:c,host:d,path:e,security:f,sni:g,fp:h,alpn:i,extra:extra={},name:j}){const l=new URLSearchParams({'type':'ws','host':d,'path':e});if(f)l['set']('security',f);if(g)l['set']('sni',g);if(h)l['set']('fp',h);if(i)l['set']('alpn',i);for(const [m,n]of Object['entries'](extra))l['set'](m,n);return'vless://'+a+'@'+b+':'+c+'?'+l['toString']()+'#'+encodeURIComponent(j);}function buildLink({core:a,proto:b,userID:c,hostName:d,address:e,port:f,tag:g}){const h=CORE_PRESETS[a][b];return createVlessLink({'userID':c,'address':e,'port':f,'host':d,'path':h['path'](),'security':h['security'],'sni':h['security']==='tls'?d:undefined,'fp':h['fp'],'alpn':h['alpn'],'extra':h['extra'],'name':makeName(g,b)});}const pick=a=>a[Math['floor'](Math['random']()*a['length'])];async function handleIpSubscription(a,b,c){const d=[c,'creativecommons.org','www.speedtest.net','sky.rethinkdns.com','cf.090227.xyz','cdnjs.com','zula.ir','cfip.1323123.xyz','go.inmobi.com','singapore.com','www.visa.com'],f=[0x1bb,0x20fb,0x805,0x823,0x827,0x830],g=[0x50,0x1f90,0x22b0,0x804,0x822,0x826,0x82f];let h=[];const i=c['endsWith']('.pages.dev');d['forEach']((j,k)=>{h['push'](buildLink({'core':a,'proto':'tls','userID':b,'hostName':c,'address':j,'port':pick(f),'tag':'D'+(k+0x1)}));if(!i)h['push'](buildLink({'core':a,'proto':'tcp','userID':b,'hostName':c,'address':j,'port':pick(g),'tag':'D'+(k+0x1)}));});try{const j=await fetch('https://raw.githubusercontent.com/NiREvil/vless/refs/heads/main/Cloudflare-IPs.json');if(j['ok']){const k=await j['json'](),l=[...k['ipv4']||[],...k['ipv6']||[]]['slice'](0x0,0x14)['map'](m=>m['ip']);l['forEach']((m,n)=>{const o=m['includes'](':')?'['+m+']':m;h['push'](buildLink({'core':a,'proto':'tls','userID':b,'hostName':c,'address':o,'port':pick(f),'tag':'IP'+(n+0x1)}));if(!i)h['push'](buildLink({'core':a,'proto':'tcp','userID':b,'hostName':c,'address':o,'port':pick(g),'tag':'IP'+(n+0x1)}));});}}catch(m){console['error']('Failed\x20to\x20fetch\x20IP\x20list:',m);}return new Response(btoa(h['join']('\x0a')),{'headers':{'Content-Type':'text/plain;charset=utf-8'}});}async function handleAdminRoutes(a,b){const c=new URL(a['url']),d=c['pathname']['replace']('/admin','');if(a['method']==='GET'&&(d==='/login'||d==='/'))return new Response(getAdminLoginHTML(),{'headers':{'Content-Type':'text/html;\x20charset=utf-8'}});if(a['method']==='GET'&&d==='/dashboard')return new Response(getAdminDashboardHTML(),{'headers':{'Content-Type':'text/html;\x20charset=utf-8'}});const f=a['headers']['get']('Authorization');if(f!==b['ADMIN_KEY'])return Response['json']({'error':'Unauthorized'},{'status':0x191});try{if(a['method']==='POST'&&d==='/api/users'){const g=await a['json'](),{id:h,expiration_date:i,expiration_time:j,notes:notes=''}=g;if(!h||!i||!j||!isValidUUID(h))return Response['json']({'error':'Missing\x20or\x20invalid\x20parameters'},{'status':0x190});const k=Math['floor'](new Date(i+'T'+j+':00Z')['getTime']()/0x3e8),l=Math['floor'](Date['now']()/0x3e8);return await b['DB']['prepare']('INSERT\x20INTO\x20users\x20(id,\x20expiration_timestamp,\x20created_at,\x20last_accessed,\x20status,\x20notes,\x20admin_key)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?)')['bind'](h,k,l,l,'active',notes||null,f)['run'](),await b['KV']['delete']('user:'+h),Response['json']({'success':!![]});}if(a['method']==='GET'&&d==='/api/users'){const {results:m}=await b['DB']['prepare']('SELECT\x20*\x20FROM\x20users\x20ORDER\x20BY\x20created_at\x20DESC')['all']();return Response['json'](m);}if(a['method']==='DELETE'&&d['startsWith']('/api/users/')){const n=d['substring']('/api/users/'['length']);if(!isValidUUID(n))return Response['json']({'error':'Invalid\x20UUID\x20format'},{'status':0x190});return await b['DB']['prepare']('DELETE\x20FROM\x20users\x20WHERE\x20id\x20=\x20?')['bind'](n)['run'](),await b['KV']['delete']('user:'+n),Response['json']({'success':!![]});}}catch(o){return console['error']('Admin\x20API\x20Error:',o),Response['json']({'error':'An\x20internal\x20server\x20error\x20occurred:\x20'+o['message']},{'status':0x1f4});}return new Response('Admin\x20endpoint\x20not\x20found',{'status':0x194});}function handleConfigPage(a,b,c){const d=generateBeautifulConfigPage(a,b,c);return new Response(d,{'headers':{'Content-Type':'text/html;\x20charset=utf-8'}});}function generateBeautifulConfigPage(a,b,c){const d=buildLink({'core':'xray','proto':'tls','userID':a,'hostName':b,'address':b,'port':0x1bb,'tag':b+'-Xray'}),e=buildLink({'core':'sb','proto':'tls','userID':a,'hostName':b,'address':b,'port':0x1bb,'tag':b+'-Singbox'}),f={'dream':d,'freedom':e},g='https://'+b+'/xray/'+a,h='https://'+b+'/sb/'+a,i={'clashMeta':'clash://install-config?url='+encodeURIComponent('https://revil-sub.pages.dev/sub/clash-meta?url='+h+'&remote_config=&udp=false&ss_uot=false&show_host=false&forced_ws0rtt=true'),'hiddify':'hiddify://install-config?url='+encodeURIComponent(g),'v2rayng':'v2rayng://install-config?url='+encodeURIComponent(g),'exclave':'sn://subscription?url='+encodeURIComponent(h)};return'\x0a\x20\x20<!doctype\x20html><html\x20lang=\x22en\x22><head><meta\x20charset=\x22UTF-8\x22\x20/><meta\x20name=\x22viewport\x22\x20content=\x22width=device-width,\x20initial-scale=1.0\x22\x20/><title>VLESS\x20Proxy\x20Configuration</title><link\x20rel=\x22icon\x22\x20href=\x22https://raw.githubusercontent.com/NiREvil/zizifn/refs/heads/Legacy/assets/favicon.png\x22\x20type=\x22image/png\x22><link\x20rel=\x22preconnect\x22\x20href=\x22https://fonts.googleapis.com\x22><link\x20rel=\x22preconnect\x22\x20href=\x22https://fonts.gstatic.com\x22\x20crossorigin><link\x20href=\x22https://fonts.googleapis.com/css2?family=Fira+Code:wght@300..700&display=swap\x22\x20rel=\x22stylesheet\x22><style>'+getPageCSS()+'</style></head><body\x20data-proxy-ip=\x22'+c+'\x22>'+getPageHTML(f,i)+'<script>'+getPageScript()+'</script></body></html>';}function getAdminLoginHTML(){return'<!DOCTYPE\x20html><html><head><title>Admin\x20Login</title><style>body{display:flex;justify-content:center;align-items:center;height:100vh;background:#1a1a1a;font-family:sans-serif;margin:0;}div{padding:2rem;background:#2a2a2a;border-radius:8px;color:white;text-align:center;}input,button{width:100%;padding:10px;margin-top:10px;border-radius:5px;border:1px\x20solid\x20#444;background:#333;color:white;box-sizing:border-box;}button{cursor:pointer;background:#007bff;}p{color:red;}</style></head><body><div><h2>Admin\x20Login</h2><input\x20type=\x22password\x22\x20id=\x22admin-key\x22\x20placeholder=\x22Enter\x20Admin\x20Key\x22><button\x20onclick=\x22login()\x22>Login</button><p\x20id=\x22error-message\x22></p></div><script>async\x20function\x20login(){const\x20key=document.getElementById(\x27admin-key\x27).value;const\x20p=document.getElementById(\x27error-message\x27);p.textContent=\x27\x27;if(!key)return\x20p.textContent=\x27Key\x20cannot\x20be\x20empty.\x27;try{const\x20res=await\x20fetch(\x27/admin/api/users\x27,{headers:{\x27Authorization\x27:key}});if(res.ok){localStorage.setItem(\x27admin_key\x27,key);window.location.href=\x27/admin/dashboard\x27;}else\x20if(res.status===401){p.textContent=\x27Invalid\x20Key.\x27;}else{p.textContent=\x27Error.\x27;}}catch(e){p.textContent=\x27Connection\x20failed.\x27;}}document.getElementById(\x27admin-key\x27).addEventListener(\x27keyup\x27,e=>{if(e.key===\x27Enter\x27)login();});</script></body></html>';}function getAdminDashboardHTML(){return'<!DOCTYPE\x20html><html\x20lang=\x22en\x22><head><meta\x20charset=\x22UTF-8\x22><meta\x20name=\x22viewport\x22\x20content=\x22width=device-width,\x20initial-scale=1.0\x22><title>Admin\x20Dashboard</title><style>body{background:#1a1a1a;font-family:sans-serif;color:#fff;padding:20px;}.dashboard{max-width:900px;margin:auto;background:#2a2a2a;border-radius:15px;padding:20px;}h1,h2{text-align:center;}.create-section{background:#333;padding:15px;border-radius:10px;margin-bottom:20px;}input,button{padding:8px;margin:5px;border:none;border-radius:5px;background:#444;color:#fff;}button{background:#007bff;cursor:pointer;}table{width:100%;border-collapse:collapse;}th,td{padding:10px;text-align:left;border-bottom:1px\x20solid\x20#444;word-break:break-all;}.expired{color:#ff5252;}</style></head><body><div\x20class=\x22dashboard\x22><h1>Admin\x20Dashboard</h1><div\x20class=\x22create-section\x22><h2>Create\x20User</h2><input\x20type=\x22text\x22\x20id=\x22new-id\x22\x20placeholder=\x22User\x20ID\x20(UUID)\x22><button\x20onclick=\x22generateUUID()\x22>Generate</button><input\x20type=\x22date\x22\x20id=\x22exp-date\x22><input\x20type=\x22time\x22\x20id=\x22exp-time\x22><input\x20type=\x22text\x22\x20id=\x22notes\x22\x20placeholder=\x22Notes\x22><button\x20onclick=\x22createUser()\x22>Create</button></div><div\x20class=\x22user-list\x22><h2>User\x20List</h2><table\x20id=\x22user-table\x22><thead><tr><th>ID</th><th>Expiry</th><th>Created</th><th>Status</th><th>Notes</th><th>Actions</th></tr></thead><tbody></tbody></table></div></div><script>const\x20adminKey=localStorage.getItem(\x27admin_key\x27);if(!adminKey)window.location.href=\x27/admin/login\x27;const\x20apiHeaders={\x27Content-Type\x27:\x27application/json\x27,\x27Authorization\x27:adminKey};async\x20function\x20apiFetch(endpoint,options={}){const\x20res=await\x20fetch(\x27/admin/api\x27+endpoint,{...options,headers:apiHeaders});if(res.status===401){alert(\x27Unauthorized!\x27);window.location.href=\x27/admin/login\x27;}return\x20res;}function\x20generateUUID(){document.getElementById(\x27new-id\x27).value=crypto.randomUUID();}async\x20function\x20createUser(){const\x20id=document.getElementById(\x27new-id\x27).value,date=document.getElementById(\x27exp-date\x27).value,time=document.getElementById(\x27exp-time\x27).value,notes=document.getElementById(\x27notes\x27).value;if(!id||!date||!time)return\x20alert(\x27Fill\x20fields.\x27);const\x20res=await\x20apiFetch(\x27/users\x27,{method:\x27POST\x27,body:JSON.stringify({id,expiration_date:date,expiration_time:time,notes})});if(res.ok){alert(\x27User\x20created!\x27);loadUsers();}else{alert(\x27Error\x20creating\x20user.\x27);}}async\x20function\x20loadUsers(){const\x20res=await\x20apiFetch(\x27/users\x27),users=await\x20res.json(),tbody=document.querySelector(\x27#user-table\x20tbody\x27);tbody.innerHTML=\x27\x27;const\x20now=Date.now()/1000;users.forEach(u=>{const\x20expiry=new\x20Date(u.expiration_timestamp*1000).toLocaleString(),created=new\x20Date(u.created_at*1000).toLocaleDateString(),statusClass=u.expiration_timestamp>now&&u.status===\x27active\x27?\x27\x27:\x27expired\x27;tbody.innerHTML+=`<tr><td>${u.id}</td><td\x20class=\x22${statusClass}\x22>${expiry}</td><td>${created}</td><td\x20class=\x22${statusClass}\x22>${u.status}</td><td>${u.notes||\x27\x27}</td><td><button\x20onclick=\x22deleteUser(\x27${u.id}\x27)\x22>Delete</button></td></tr>`;});}async\x20function\x20deleteUser(id){if(!confirm(\x27Delete\x20user?\x27))return;const\x20res=await\x20apiFetch(`/users/${id}`,{method:\x27DELETE\x27});if(res.ok){alert(\x27User\x20deleted!\x27);loadUsers();}else{alert(\x27Error\x20deleting\x20user.\x27);}}window.onload=()=>{generateUUID();loadUsers();};</script></body></html>';}function getPageCSS(){return'*{margin:0;padding:0;box-sizing:border-box}\x20@font-face{font-family:\x22Aldine\x20401\x20BT\x20Web\x22;src:url(\x22https://pub-7a3b428c76aa411181a0f4dd7fa9064b.r2.dev/Aldine401_Mersedeh.woff2\x22)\x20format(\x22woff2\x22);font-weight:400;font-style:normal;font-display:swap}\x20@font-face{font-family:\x22Styrene\x20B\x20LC\x22;src:url(\x22https://pub-7a3b428c76aa411181a0f4dd7fa9064b.r2.dev/StyreneBLC-Regular.woff2\x22)\x20format(\x22woff2\x22);font-weight:400;font-style:normal;font-display:swap}\x20@font-face{font-family:\x22Styrene\x20B\x20LC\x22;src:url(\x22https://pub-7a3b428c76aa411181a0f4dd7fa9064b.r2.dev/StyreneBLC-Medium.woff2\x22)\x20format(\x22woff2\x22);font-weight:500;font-style:normal;font-display:swap}\x20:root{--background-primary:#2a2421;--background-secondary:#35302c;--background-tertiary:#413b35;--border-color:#5a4f45;--border-color-hover:#766a5f;--text-primary:#e5dfd6;--text-secondary:#b3a89d;--text-accent:#fff;--accent-primary:#be9b7b;--accent-secondary:#d4b595;--accent-tertiary:#8d6e5c;--accent-primary-darker:#8a6f56;--button-text-primary:#2a2421;--button-text-secondary:var(--text-primary);--shadow-color:rgba(0,0,0,.35);--shadow-color-accent:rgba(190,155,123,.4);--border-radius:8px;--transition-speed:.2s;--serif:\x22Aldine\x20401\x20BT\x20Web\x22,\x22Times\x20New\x20Roman\x22,Times,Georgia,ui-serif,serif;--sans-serif:\x22Styrene\x20B\x20LC\x22,-apple-system,BlinkMacSystemFont,\x22Segoe\x20UI\x22,Helvetica,Arial,\x22Noto\x20Color\x20Emoji\x22,sans-serif;--mono-serif:\x22Fira\x20Code\x22,Cantarell,\x22Courier\x20Prime\x22,monospace}\x20body{font-family:var(--sans-serif);font-size:16px;background-color:var(--background-primary);color:var(--text-primary);padding:3rem;line-height:1.5;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}\x20.container{max-width:800px;margin:20px\x20auto;padding:0\x2012px;border-radius:var(--border-radius);box-shadow:0\x206px\x2015px\x20rgba(0,0,0,.2),0\x200\x2025px\x208px\x20var(--shadow-color-accent);transition:box-shadow\x20.3s\x20ease}\x20.container:hover{box-shadow:0\x208px\x2020px\x20rgba(0,0,0,.25),0\x200\x2035px\x2010px\x20var(--shadow-color-accent)}\x20.header{text-align:center;margin-bottom:40px;padding-top:30px}\x20.header\x20h1{font-family:var(--serif);font-weight:400;font-size:1.8rem;color:var(--text-accent);margin-bottom:2px}\x20.header\x20p{color:var(--text-secondary);font-size:.6rem}\x20.config-card{background:var(--background-secondary);border-radius:var(--border-radius);padding:20px;margin-bottom:24px;border:1px\x20solid\x20var(--border-color);transition:border-color\x20var(--transition-speed)\x20ease,box-shadow\x20var(--transition-speed)\x20ease}\x20.config-card:hover{border-color:var(--border-color-hover);box-shadow:0\x204px\x208px\x20var(--shadow-color)}\x20.config-title{font-family:var(--serif);font-size:1.6rem;font-weight:400;color:var(--accent-secondary);margin-bottom:16px;padding-bottom:13px;border-bottom:1px\x20solid\x20var(--border-color);display:flex;align-items:center;justify-content:space-between}\x20.config-title\x20.refresh-btn{position:relative;overflow:hidden;display:flex;align-items:center;gap:4px;font-family:var(--serif);font-size:12px;padding:6px\x2012px;border-radius:6px;color:var(--accent-secondary);background-color:var(--background-tertiary);border:1px\x20solid\x20var(--border-color);cursor:pointer;transition:all\x20var(--transition-speed)\x20ease}\x20.config-title\x20.refresh-btn::before{content:\x27\x27;position:absolute;top:0;left:0;width:100%;height:100%;background:linear-gradient(120deg,transparent,rgba(255,255,255,.2),transparent);transform:translateX(-100%);transition:transform\x20.6s\x20ease;z-index:1}\x20.config-title\x20.refresh-btn:hover{letter-spacing:.5px;font-weight:600;background-color:#4d453e;color:var(--accent-primary);border-color:var(--border-color-hover);transform:translateY(-2px);box-shadow:0\x204px\x208px\x20var(--shadow-color)}\x20.config-title\x20.refresh-btn:hover::before{transform:translateX(100%)}\x20.config-title\x20.refresh-btn:active{transform:translateY(0)\x20scale(.98);box-shadow:none}\x20.refresh-icon,.copy-icon{width:12px;height:12px;stroke:currentColor}\x20.config-content{position:relative;background:var(--background-tertiary);border-radius:var(--border-radius);padding:16px;margin-bottom:20px;border:1px\x20solid\x20var(--border-color)}\x20.config-content\x20pre{overflow-x:auto;font-family:var(--mono-serif);font-size:7px;color:var(--text-primary);margin:0;white-space:pre-wrap;word-break:break-all}\x20.button{display:inline-flex;align-items:center;justify-content:center;gap:8px;padding:8px\x2016px;border-radius:var(--border-radius);font-size:15px;font-weight:500;cursor:pointer;border:1px\x20solid\x20var(--border-color);background-color:var(--background-tertiary);color:var(--button-text-secondary);transition:all\x20var(--transition-speed)\x20ease;-webkit-tap-highlight-color:transparent;text-decoration:none;overflow:hidden;z-index:1}\x20.button:focus-visible{outline:2px\x20solid\x20var(--accent-primary);outline-offset:2px}\x20.button:disabled{opacity:.6;cursor:not-allowed;transform:none;box-shadow:none}\x20.copy-buttons{position:relative;display:flex;gap:4px;overflow:hidden;align-self:center;font-family:var(--serif);font-size:13px;padding:6px\x2012px;border-radius:6px;color:var(--accent-secondary);border:1px\x20solid\x20var(--border-color);transition:all\x20var(--transition-speed)\x20ease}\x20.copy-buttons::before,.client-btn::before{content:\x27\x27;position:absolute;top:0;left:0;width:100%;height:100%;background:linear-gradient(120deg,transparent,rgba(255,255,255,.2),transparent);transform:translateX(-100%);transition:transform\x20.6s\x20ease;z-index:-1}\x20.copy-buttons:hover::before,.client-btn:hover::before{transform:translateX(100%)}\x20.copy-buttons:hover{background-color:#4d453e;letter-spacing:.5px;font-weight:600;border-color:var(--border-color-hover);transform:translateY(-2px);box-shadow:0\x204px\x208px\x20var(--shadow-color)}\x20.copy-buttons:active{transform:translateY(0)\x20scale(.98);box-shadow:none}\x20.client-buttons{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:12px;margin-top:16px}\x20.client-btn{width:100%;background-color:var(--accent-primary);color:var(--background-tertiary);border-radius:6px;border-color:var(--accent-primary-darker);position:relative;overflow:hidden;transition:all\x20.3s\x20cubic-bezier(.2,.8,.2,1);box-shadow:0\x202px\x205px\x20rgba(0,0,0,.15)}\x20.client-btn::after{content:\x27\x27;position:absolute;bottom:-5px;left:0;width:100%;height:5px;background:linear-gradient(90deg,var(--accent-tertiary),var(--accent-secondary));opacity:0;transition:all\x20.3s\x20ease;z-index:0}\x20.client-btn:hover{text-transform:uppercase;letter-spacing:.3px;transform:translateY(-3px);background-color:var(--accent-secondary);color:var(--button-text-primary);box-shadow:0\x205px\x2015px\x20rgba(190,155,123,.5);border-color:var(--accent-secondary)}\x20.client-btn:hover::after{opacity:1;bottom:0}\x20.client-btn:active{transform:translateY(0)\x20scale(.98);box-shadow:0\x202px\x203px\x20rgba(0,0,0,.2);background-color:var(--accent-primary-darker)}\x20.client-btn\x20.client-icon{position:relative;z-index:2;transition:transform\x20.3s\x20ease}\x20.client-btn:hover\x20.client-icon{transform:rotate(15deg)\x20scale(1.1)}\x20.client-btn\x20.button-text{position:relative;z-index:2;transition:letter-spacing\x20.3s\x20ease}\x20.client-btn:hover\x20.button-text{letter-spacing:.5px}\x20.client-icon{width:18px;height:18px;border-radius:6px;background-color:var(--background-secondary);display:flex;align-items:center;justify-content:center;flex-shrink:0}\x20.client-icon\x20svg{width:14px;height:14px;fill:var(--accent-secondary)}\x20.button.copied{background-color:var(--accent-secondary)!important;color:var(--background-tertiary)!important}\x20.footer{text-align:center;margin-top:20px;padding-bottom:40px;color:var(--text-secondary);font-size:8px}\x20.footer\x20p{margin:0}\x20::-webkit-scrollbar{width:8px;height:8px}\x20::-webkit-scrollbar-track{background:var(--background-primary);border-radius:4px}\x20::-webkit-scrollbar-thumb{background:var(--border-color);border-radius:4px;border:2px\x20solid\x20var(--background-primary)}\x20::-webkit-scrollbar-thumb:hover{background:var(--border-color-hover)}\x20*{scrollbar-width:thin;scrollbar-color:var(--border-color)\x20var(--background-primary)}\x20.ip-info-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(230px,1fr));gap:24px}\x20.ip-info-section{background-color:var(--background-tertiary);border-radius:var(--border-radius);padding:16px;border:1px\x20solid\x20var(--border-color);display:flex;flex-direction:column;gap:20px}\x20.ip-info-header{display:flex;align-items:center;gap:10px;border-bottom:1px\x20solid\x20var(--border-color);padding-bottom:10px}\x20.ip-info-header\x20svg{width:20px;height:20px;stroke:var(--accent-secondary)}\x20.ip-info-header\x20h3{font-family:var(--serif);font-size:18px;font-weight:400;color:var(--accent-secondary);margin:0}\x20.ip-info-content{display:flex;flex-direction:column;gap:10px}\x20.ip-info-item{display:flex;flex-direction:column;gap:2px}\x20.ip-info-item\x20.label{font-size:11px;color:var(--text-secondary);text-transform:uppercase;letter-spacing:.5px}\x20.ip-info-item\x20.value{font-size:14px;color:var(--text-primary);word-break:break-all;line-height:1.4}\x20.badge{display:inline-flex;align-items:center;justify-content:center;padding:3px\x208px;border-radius:12px;font-size:11px;font-weight:500;text-transform:uppercase;letter-spacing:.5px}\x20.badge-yes{background-color:rgba(112,181,112,.15);color:#70b570;border:1px\x20solid\x20rgba(112,181,112,.3)}\x20.badge-no{background-color:rgba(224,93,68,.15);color:#e05d44;border:1px\x20solid\x20rgba(224,93,68,.3)}\x20.badge-neutral{background-color:rgba(79,144,196,.15);color:#4f90c4;border:1px\x20solid\x20rgba(79,144,196,.3)}\x20.badge-warning{background-color:rgba(224,188,68,.15);color:#e0bc44;border:1px\x20solid\x20rgba(224,188,68,.3)}\x20.skeleton{display:block;background:linear-gradient(90deg,var(--background-tertiary)\x2025%,var(--background-secondary)\x2050%,var(--background-tertiary)\x2075%);background-size:200%\x20100%;animation:loading\x201.5s\x20infinite;border-radius:4px;height:16px}\x20@keyframes\x20loading{0%{background-position:200%\x200}100%{background-position:-200%\x200}}\x20.country-flag{display:inline-block;width:18px;height:auto;max-height:14px;margin-right:6px;vertical-align:middle;border-radius:2px}\x20@media\x20(max-width:768px){body{padding:20px}\x20.container{padding:0\x2014px;width:min(100%,768px)}\x20.ip-info-grid{grid-template-columns:repeat(auto-fit,minmax(170px,1fr));gap:18px}\x20.header\x20h1{font-size:1.8rem}\x20.header\x20p{font-size:.7rem}\x20.ip-info-section{padding:14px;gap:18px}\x20.ip-info-header\x20h3{font-size:16px}\x20.ip-info-header{gap:8px}\x20.ip-info-content{gap:8px}\x20.ip-info-item\x20.label{font-size:11px}\x20.ip-info-item\x20.value{font-size:13px}\x20.config-card{padding:16px}\x20.config-title{font-size:18px}\x20.config-title\x20.refresh-btn{font-size:11px}\x20.config-content\x20pre{font-size:12px}\x20.client-buttons{grid-template-columns:repeat(auto-fill,minmax(260px,1fr))}\x20.button{font-size:12px}\x20.copy-buttons{font-size:11px}}\x20@media\x20(max-width:480px){body{padding:16px}\x20.container{padding:0\x2012px;width:min(100%,390px)}\x20.header\x20h1{font-size:20px}\x20.header\x20p{font-size:8px}\x20.ip-info-section{padding:14px;gap:16px}\x20.ip-info-grid{grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px}\x20.ip-info-header\x20h3{font-size:14px}\x20.ip-info-header{gap:6px}\x20.ip-info-content{gap:6px}\x20.ip-info-item\x20.label{font-size:9px}\x20.ip-info-item\x20.value{font-size:11px}\x20.badge{padding:2px\x206px;font-size:10px;border-radius:10px}\x20.config-card{padding:10px}\x20.config-title{font-size:16px}\x20.config-title\x20.refresh-btn{font-size:10px}\x20.config-content{padding:12px}\x20.config-content\x20pre{font-size:10px}\x20.client-buttons{grid-template-columns:repeat(auto-fill,minmax(200px,1fr))}\x20.button{padding:4px\x208px;font-size:11px}\x20.copy-buttons{font-size:10px}\x20.footer{font-size:10px}}\x20@media\x20(max-width:359px){body{padding:12px;font-size:14px}\x20.container{max-width:100%;padding:8px}\x20.header\x20h1{font-size:16px}\x20.header\x20p{font-size:6px}\x20.ip-info-section{padding:12px;gap:12px}\x20.ip-info-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:10px}\x20.ip-info-header\x20h3{font-size:13px}\x20.ip-info-header{gap:4px}\x20.ip-info-content{gap:4px}\x20.ip-info-header\x20svg{width:16px;height:16px}\x20.ip-info-item\x20.label{font-size:8px}\x20.ip-info-item\x20.value{font-size:10px}\x20.badge{padding:1px\x204px;font-size:9px;border-radius:8px}\x20.config-card{padding:8px}\x20.config-title{font-size:13px}\x20.config-title\x20.refresh-btn{font-size:9px}\x20.config-content{padding:8px}\x20.config-content\x20pre{font-size:8px}\x20.client-buttons{grid-template-columns:repeat(auto-fill,minmax(150px,1fr))}\x20.button{padding:3px\x206px;font-size:10px}\x20.copy-buttons{font-size:9px}\x20.footer{font-size:7px}}\x20@media\x20(min-width:360px){.container{max-width:95%}}\x20@media\x20(min-width:480px){.container{max-width:90%}}\x20@media\x20(min-width:640px){.container{max-width:600px}}\x20@media\x20(min-width:768px){.container{max-width:720px}}\x20@media\x20(min-width:1024px){.container{max-width:800px}}';}function getPageHTML(a,b){return'<div\x20class=\x22container\x22><div\x20class=\x22header\x22><h1>VLESS\x20Proxy\x20Configuration</h1><p>Copy\x20the\x20configuration\x20or\x20import\x20directly\x20into\x20your\x20client</p></div><div\x20class=\x22config-card\x22><div\x20class=\x22config-title\x22><span>Network\x20Information</span><button\x20id=\x22refresh-ip-info\x22\x20class=\x22refresh-btn\x22\x20aria-label=\x22Refresh\x20IP\x20information\x22><svg\x20class=\x22refresh-icon\x22\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><path\x20d=\x22M21.5\x202v6h-6M2.5\x2022v-6h6M2\x2011.5a10\x2010\x200\x200\x201\x2018.8-4.3M22\x2012.5a10\x2010\x200\x200\x201-18.8\x204.2\x22/></svg>\x20Refresh</button></div><div\x20class=\x22ip-info-grid\x22><div\x20class=\x22ip-info-section\x22><div\x20class=\x22ip-info-header\x22><svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><path\x20d=\x22M15.5\x202H8.6c-.4\x200-.8.2-1.1.5-.3.3-.5.7-.5\x201.1v16.8c0\x20.4.2.8.5\x201.1.3.3.7.5\x201.1.5h6.9c.4\x200\x20.8-.2\x201.1-.5.3-.3.5-.7.5-1.1V3.6c0-.4-.2-.8-.5-1.1-.3-.3-.7-.5-1.1-.5z\x22/><circle\x20cx=\x2212\x22\x20cy=\x2218\x22\x20r=\x221\x22/></svg><h3>Proxy\x20Server</h3></div><div\x20class=\x22ip-info-content\x22><div\x20class=\x22ip-info-item\x22><span\x20class=\x22label\x22>Proxy\x20Host</span><span\x20class=\x22value\x22\x20id=\x22proxy-host\x22><span\x20class=\x22skeleton\x22\x20style=\x22width:150px\x22></span></span></div><div\x20class=\x22ip-info-item\x22><span\x20class=\x22label\x22>IP\x20Address</span><span\x20class=\x22value\x22\x20id=\x22proxy-ip\x22><span\x20class=\x22skeleton\x22\x20style=\x22width:120px\x22></span></span></div><div\x20class=\x22ip-info-item\x22><span\x20class=\x22label\x22>Location</span><span\x20class=\x22value\x22\x20id=\x22proxy-location\x22><span\x20class=\x22skeleton\x22\x20style=\x22width:100px\x22></span></span></div><div\x20class=\x22ip-info-item\x22><span\x20class=\x22label\x22>ISP\x20Provider</span><span\x20class=\x22value\x22\x20id=\x22proxy-isp\x22><span\x20class=\x22skeleton\x22\x20style=\x22width:140px\x22></span></span></div></div></div><div\x20class=\x22ip-info-section\x22><div\x20class=\x22ip-info-header\x22><svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><path\x20d=\x22M20\x2016V7a2\x202\x200\x200\x200-2-2H6a2\x202\x200\x200\x200-2\x202v9m16\x200H4m16\x200\x201.28\x202.55a1\x201\x200\x200\x201-.9\x201.45H3.62a1\x201\x200\x200\x201-.9-1.45L4\x2016\x22/></svg><h3>Your\x20Connection</h3></div><div\x20class=\x22ip-info-content\x22><div\x20class=\x22ip-info-item\x22><span\x20class=\x22label\x22>Your\x20IP</span><span\x20class=\x22value\x22\x20id=\x22client-ip\x22><span\x20class=\x22skeleton\x22\x20style=\x22width:110px\x22></span></span></div><div\x20class=\x22ip-info-item\x22><span\x20class=\x22label\x22>Location</span><span\x20class=\x22value\x22\x20id=\x22client-location\x22><span\x20class=\x22skeleton\x22\x20style=\x22width:90px\x22></span></span></div><div\x20class=\x22ip-info-item\x22><span\x20class=\x22label\x22>ISP\x20Provider</span><span\x20class=\x22value\x22\x20id=\x22client-isp\x22><span\x20class=\x22skeleton\x22\x20style=\x22width:130px\x22></span></span></div><div\x20class=\x22ip-info-item\x22><span\x20class=\x22label\x22>Risk\x20Score</span><span\x20class=\x22value\x22\x20id=\x22client-proxy\x22><span\x20class=\x22skeleton\x22\x20style=\x22width:100px\x22></span></span></div></div></div></div></div><div\x20class=\x22config-card\x22><div\x20class=\x22config-title\x22><span>Xray\x20Core\x20Clients</span><button\x20class=\x22button\x20copy-buttons\x22\x20onclick=\x22copyToClipboard(this,\x27'+a['dream']+'\x27)\x22><svg\x20class=\x22copy-icon\x22\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><rect\x20x=\x229\x22\x20y=\x229\x22\x20width=\x2213\x22\x20height=\x2213\x22\x20rx=\x222\x22\x20ry=\x222\x22/><path\x20d=\x22M5\x2015H4a2\x202\x200\x200\x201-2-2V4a2\x202\x200\x200\x201\x202-2h9a2\x202\x200\x200\x201\x202\x202v1\x22/></svg>\x20Copy</button></div><div\x20class=\x22config-content\x22><pre\x20id=\x22xray-config\x22>'+a['dream']+'</pre></div><div\x20class=\x22client-buttons\x22><a\x20href=\x22'+b['hiddify']+'\x22\x20class=\x22button\x20client-btn\x22><span\x20class=\x22client-icon\x22><svg\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M12\x202\x202\x207l10\x205\x2010-5-10-5zM2\x2017l10\x205\x2010-5M2\x2012l10\x205\x2010-5\x22/></svg></span><span\x20class=\x22button-text\x22>Import\x20to\x20Hiddify</span></a><a\x20href=\x22'+b['v2rayng']+'\x22\x20class=\x22button\x20client-btn\x22><span\x20class=\x22client-icon\x22><svg\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M12\x202\x204\x205v6c0\x205.5\x203.5\x2010.7\x208\x2012.3\x204.5-1.6\x208-6.8\x208-12.3V5l-8-3z\x22/></svg></span><span\x20class=\x22button-text\x22>Import\x20to\x20V2rayNG</span></a></div></div><div\x20class=\x22config-card\x22><div\x20class=\x22config-title\x22><span>Sing-Box\x20Core\x20Clients</span><button\x20class=\x22button\x20copy-buttons\x22\x20onclick=\x22copyToClipboard(this,\x27'+a['freedom']+'\x27)\x22><svg\x20class=\x22copy-icon\x22\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><rect\x20x=\x229\x22\x20y=\x229\x22\x20width=\x2213\x22\x20height=\x2213\x22\x20rx=\x222\x22\x20ry=\x222\x22/><path\x20d=\x22M5\x2015H4a2\x202\x200\x200\x201-2-2V4a2\x202\x200\x200\x201\x202-2h9a2\x202\x200\x200\x201\x202\x202v1\x22/></svg>\x20Copy</button></div><div\x20class=\x22config-content\x22><pre\x20id=\x22singbox-config\x22>'+a['freedom']+'</pre></div><div\x20class=\x22client-buttons\x22><a\x20href=\x22'+b['clashMeta']+'\x22\x20class=\x22button\x20client-btn\x22><span\x20class=\x22client-icon\x22><svg\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M12\x202C6.48\x202\x202\x206.48\x202\x2012s4.48\x2010\x2010\x2010\x2010-4.48\x2010-10S17.52\x202\x2012\x202zm-1\x2017.93c-3.95-.49-7-3.85-7-7.93\x200-.62.08-1.21.21-1.79L9\x2015v1c0\x201.1.9\x202\x202\x202v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55\x200\x201-.45\x201-1V7h2c1.1\x200\x202-.9\x202-2v-.41c2.93\x201.19\x205\x204.06\x205\x207.41\x200\x202.08-.8\x203.97-2.1\x205.39z\x22/></svg></span><span\x20class=\x22button-text\x22>Import\x20to\x20Clash\x20Meta</span></a><a\x20href=\x22'+b['exclave']+'\x22\x20class=\x22button\x20client-btn\x22><span\x20class=\x22client-icon\x22><svg\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M20\x208h-3V6c0-1.1-.9-2-2-2H9C7.9\x204\x207\x204.9\x207\x206v2H4C2.9\x208\x202\x208.9\x202\x2010v9c0\x201.1.9\x202\x202\x202h16c1.1\x200\x202-.9\x202-2v-9C22\x208.9\x2021.1\x208\x2020\x208zM9\x206h6v2H9V6zM20\x2019H4v-2h16v-2zM20\x2015H4v-5h3v1c0\x20.55.45\x201\x201\x201h1.5c.28\x200\x20.5-.22.5-.5v-.5h4v.5c0\x20.28.22.5.5.5H16c.55\x200\x201-.45\x201-1v-1h3v2z\x22/><circle\x20cx=\x228.5\x22\x20cy=\x2213.5\x22\x20r=\x221\x22/><circle\x20cx=\x2215.5\x22\x20cy=\x2213.5\x22\x20r=\x221\x22/><path\x20d=\x22M12\x2015.5c-.55\x200-1-.45-1-1h2c-.01-.55-.46-1-1-1z\x22/></svg></span><span\x20class=\x22button-text\x22>Import\x20to\x20Exclave</span></a></div></div><div\x20class=\x22footer\x22><p>©\x20<span\x20id=\x22current-year\x22>'+new Date()['getFullYear']()+'</span>\x20REvil\x20-\x20All\x20Rights\x20Reserved</p><p>Secure.\x20Private.\x20Fast.</p></div></div>';}function getPageScript(){return'function\x20copyToClipboard(btn,text){const\x20original=btn.innerHTML;navigator.clipboard.writeText(text).then(()=>{btn.innerHTML=`<svg\x20class=\x22copy-icon\x22\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><path\x20d=\x22M22\x2011.08V12a10\x2010\x200\x201\x201-5.93-9.14\x22/><polyline\x20points=\x2222\x204\x2012\x2014.01\x209\x2011.01\x22/></svg>\x20Copied!`;btn.classList.add(\x22copied\x22);btn.disabled=true;setTimeout(()=>{btn.innerHTML=original;btn.classList.remove(\x22copied\x22);btn.disabled=false},1200)}).catch(e=>console.error(\x22Failed\x20to\x20copy:\x22,e))}function\x20updateDisplay(data){const\x20p=data.proxy||{},c=data.client||{};document.getElementById(\x22proxy-host\x22).textContent=p.host||\x22N/A\x22;document.getElementById(\x22proxy-ip\x22).textContent=p.ip||\x22N/A\x22;document.getElementById(\x22proxy-isp\x22).textContent=p.isp||\x22N/A\x22;const\x20p_loc=[p.city,p.country].filter(Boolean).join(\x22,\x20\x22),p_flag=p.country?`<img\x20src=\x22https://flagcdn.com/w20/${p.country.toLowerCase()}.png\x22\x20class=\x22country-flag\x22\x20alt=\x22${p.country}\x22>\x20`:\x27\x27;document.getElementById(\x22proxy-location\x22).innerHTML=p_loc?`${p_flag}${p_loc}`:\x22N/A\x22;document.getElementById(\x22client-ip\x22).textContent=c.ip||\x22N/A\x22;document.getElementById(\x22client-isp\x22).textContent=c.isp||\x22N/A\x22;const\x20c_loc=[c.city,c.country].filter(Boolean).join(\x22,\x20\x22),c_flag=c.country?`<img\x20src=\x22https://flagcdn.com/w20/${c.country.toLowerCase()}.png\x22\x20class=\x22country-flag\x22\x20alt=\x22${c.country}\x22>\x20`:\x27\x27;document.getElementById(\x22client-location\x22).innerHTML=c_loc?`${c_flag}${c_loc}`:\x22N/A\x22;const\x20risk=c.risk;let\x20riskText=\x22Unknown\x22,badgeClass=\x22badge-neutral\x22;if(risk&&risk.score!==undefined){riskText=`${risk.score}\x20-\x20${risk.risk.charAt(0).toUpperCase()+risk.risk.slice(1)}`;switch(risk.risk.toLowerCase()){case\x22low\x22:badgeClass=\x22badge-yes\x22;break;case\x22medium\x22:badgeClass=\x22badge-warning\x22;break;case\x22high\x22:case\x22very\x20high\x22:badgeClass=\x22badge-no\x22;break}}document.getElementById(\x22client-proxy\x22).innerHTML=`<span\x20class=\x22badge\x20${badgeClass}\x22>${riskText}</span>`}async\x20function\x20loadNetworkInfo(){try{const\x20res=await\x20fetch(\x22/api/network-info\x22);if(!res.ok)throw\x20new\x20Error(`API\x20failed:\x20${res.status}`);updateDisplay(await\x20res.json())}catch(e){console.error(\x22Failed\x20to\x20load\x20network\x20info:\x22,e);updateDisplay({client:{},proxy:{host:document.body.getAttribute(\x22data-proxy-ip\x22)}})}}document.getElementById(\x22refresh-ip-info\x22)?.addEventListener(\x22click\x22,function(){const\x20btn=this,icon=btn.querySelector(\x22.refresh-icon\x22);btn.disabled=true;if(icon)icon.style.animation=\x22spin\x201s\x20linear\x20infinite\x22;const\x20reset=p=>{[\x22ip\x22,\x22location\x22,\x22isp\x22].forEach(k=>{const\x20el=document.getElementById(`${p}-${k}`);if(el)el.innerHTML=`<span\x20class=\x22skeleton\x22\x20style=\x22width:120px;\x22></span>`});if(p===\x22proxy\x22)document.getElementById(\x22proxy-host\x22).innerHTML=`<span\x20class=\x22skeleton\x22\x20style=\x22width:120px;\x22></span>`;if(p===\x22client\x22)document.getElementById(\x22client-proxy\x22).innerHTML=`<span\x20class=\x22skeleton\x22\x20style=\x22width:120px;\x22></span>`};reset(\x22proxy\x22);reset(\x22client\x22);loadNetworkInfo().finally(()=>setTimeout(()=>{btn.disabled=false;if(icon)icon.style.animation=\x22\x22},500))});const\x20style=document.createElement(\x22style\x22);style.textContent=`@keyframes\x20spin{to{transform:rotate(360deg)}}`;document.head.appendChild(style);document.addEventListener(\x22DOMContentLoaded\x22,loadNetworkInfo);';}