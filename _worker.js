// <!--GAMFC--> version base on commit d302873f4e3983d98bbfdecdd86f8611c929b7e4, time is 2025-10-02 13:27:18 UTC<!--We are all REvil-->
// @ts-ignore

import{connect}from'cloudflare:sockets';const Config={'defaultProxyIPs':['nima.nscl.ir:443'],'defaultDoHUpstream':'https://chrome.cloudflare-dns.com/dns-query','scamalytics':{'username':'revilseptember','apiKey':'b2fc368184deb3d8ac914bd776b8215fe899dd8fef69fbaba77511acfbdeca0d','baseUrl':'https://api12.scamalytics.com/v3/'},'fromEnv'(a){const b=a['PROXYIP']?a['PROXYIP']['split'](',')['map'](f=>f['trim']()):this['defaultProxyIPs'],c=b[Math['floor'](Math['random']()*b['length'])],[d,e='443']=c['split'](':');return{'proxyAddress':c,'proxyIP':d,'proxyPort':parseInt(e,0xa),'dohUpstreamUrl':a['DOH_UPSTREAM_URL']||this['defaultDoHUpstream'],'scamalytics':{'username':a['SCAMALYTICS_USERNAME']||this['scamalytics']['username'],'apiKey':a['SCAMALYTICS_API_KEY']||this['scamalytics']['apiKey'],'baseUrl':a['SCAMALYTICS_BASEURL']||this['scamalytics']['baseUrl']}};}},CONST={'WS_READY_STATE_OPEN':0x1,'WS_READY_STATE_CLOSING':0x2};export default{async 'fetch'(a,b,c){try{const d=new URL(a['url']),e=Config['fromEnv'](b);if(a['headers']['get']('Upgrade')?.['toLowerCase']()==='websocket')return handleWebSocket(a,b,c);if(d['pathname']==='/dns-query'&&['POST','GET']['includes'](a['method']))return handleDnsQuery(a,e['dohUpstreamUrl']);if(d['pathname']==='/api/network-info')return handleNetworkInfo(a,e);if(d['pathname']['startsWith']('/admin')){if(!b['DB']||!b['KV']||!b['ADMIN_KEY'])return new Response('Admin\x20panel\x20is\x20not\x20configured.\x20D1,\x20KV,\x20or\x20ADMIN_KEY\x20binding\x20is\x20missing.',{'status':0x1f7});if(!b['ADMIN_KEY'])console['error']('CRITICAL:\x20ADMIN_KEY\x20secret\x20is\x20not\x20set\x20in\x20environment\x20variables.');return handleAdminRoutes(a,b);}const f=d['pathname']['slice'](0x1)['split']('/');let g;if((f[0x0]==='xray'||f[0x0]==='sb')&&f['length']>0x1)g=f[0x1];else f['length']===0x1&&isValidUUID(f[0x0])&&(g=f[0x0]);if(g){if(b['DB']&&b['KV']&&!await isValidUser(g,b,c))return new Response('Invalid\x20or\x20expired\x20user\x20ID.',{'status':0x193});if(f[0x0]==='xray'||f[0x0]==='sb')return handleIpSubscription(f[0x0],g,d['hostname']);return handleConfigPage(g,d['hostname'],e['proxyAddress']);}return new Response('Not\x20Found.\x20Please\x20use\x20your\x20unique\x20user\x20ID\x20in\x20the\x20URL\x20path.',{'status':0x194});}catch(h){return console['error']('Unhandled\x20Exception:',h['stack']||h),new Response('Internal\x20Server\x20Error',{'status':0x1f4});}}};async function handleDnsQuery(a,b){const c=new URL(a['url']),d=new URL(b);d['search']=c['search'];const f=new Request(d,{'method':a['method'],'headers':{'Content-Type':'application/dns-message','Accept':'application/dns-message','User-Agent':a['headers']['get']('User-Agent')||'Cloudflare-Worker-DoH-Proxy'},'body':a['method']==='POST'?a['body']:null});try{const g=await fetch(f);if(!g['ok'])return console['error']('DoH\x20upstream\x20error:\x20'+g['status']+'\x20'+g['statusText']),new Response('DNS\x20upstream\x20server\x20returned\x20an\x20error.',{'status':0x1f6});return g;}catch(h){return console['error']('DoH\x20proxy\x20failed:',h),new Response('DNS\x20query\x20proxy\x20failed.',{'status':0x1f6});}}async function handleWebSocket(a,b,c){const d=new WebSocketPair(),[e,f]=Object['values'](d);f['accept']();const g=(l,m)=>console['log']('[WS]\x20'+l,m||''),h=a['headers']['get']('Sec-WebSocket-Protocol')||'',i=makeReadableWebSocketStream(f,h,g);let j={'value':null},k=![];return i['pipeTo'](new WritableStream({async 'write'(l,m){if(k&&j['value']){const w=j['value']['writable']['getWriter']();try{await w['write'](l);}finally{w['releaseLock']();}return;}const {hasError:n,message:o,addressRemote:p,portRemote:q,rawDataIndex:r,ProtocolVersion:s,isUDP:t}=await processVlessHeader(l,b,c);if(n)return g('VLESS\x20Header\x20Error:\x20'+o),m['error'](new Error(o));if(t){g('UDP\x20traffic\x20to\x20'+p+':'+q+'\x20blocked.\x20Configure\x20client\x20DNS\x20to\x20use\x20this\x20worker\x27s\x20/dns-query\x20endpoint.');return;}const u=l['slice'](r),v=await handleTCPOutbound({'addressRemote':p,'portRemote':q,'vlessResponseHeader':new Uint8Array([s[0x0],0x0]),'initialClientData':u,'webSocket':f,'log':(x,y)=>console['log']('['+p+':'+q+']\x20'+x,y||'')});if(!v)return m['error'](new Error('Failed\x20to\x20establish\x20remote\x20connection.'));j['value']=v,k=!![],v['readable']['pipeTo'](new WritableStream({'write'(x){f['readyState']===CONST['WS_READY_STATE_OPEN']&&f['send'](x);},'close':()=>g('Remote\x20socket\x20readable\x20stream\x20closed.'),'abort':x=>g('Remote\x20socket\x20readable\x20stream\x20aborted:',x)}))['catch'](x=>g('Error\x20piping\x20remote\x20to\x20WebSocket:',x));},'abort':l=>g('WebSocket\x20readable\x20stream\x20aborted:',l)}))['catch'](l=>{g('WebSocket\x20pipeline\x20failed:',l),safeCloseWebSocket(f);}),new Response(null,{'status':0x65,'webSocket':e});}async function handleTCPOutbound({addressRemote:a,portRemote:b,vlessResponseHeader:c,initialClientData:d,webSocket:e,log:f}){try{f('Connecting\x20to\x20destination...');const g=await connect({'hostname':a,'port':b});f('Connection\x20successful.');e['readyState']===CONST['WS_READY_STATE_OPEN']&&e['send'](c);const h=g['writable']['getWriter']();return await h['write'](d),h['releaseLock'](),g;}catch(i){return f('Connection\x20to\x20'+a+':'+b+'\x20failed',i),safeCloseWebSocket(e,0x3f3,'Proxy\x20connection\x20failed:\x20'+i['message']),null;}}async function processVlessHeader(a,b,c){if(a['byteLength']<0x18)return{'hasError':!![],'message':'Invalid\x20VLESS\x20header'};const d=new DataView(a),e=d['getUint8'](0x0),f=stringify(new Uint8Array(a['slice'](0x1,0x11)));if(b['DB']&&b['KV']&&!await isValidUser(f,b,c))return{'hasError':!![],'message':'Invalid\x20user'};const g=d['getUint8'](0x11),h=d['getUint8'](0x12+g),i=0x12+g+0x1,j=d['getUint16'](i),k=d['getUint8'](i+0x2);let l,m;switch(k){case 0x1:l=new Uint8Array(a['slice'](i+0x3,i+0x7))['join']('.'),m=i+0x7;break;case 0x2:const n=d['getUint8'](i+0x3);l=new TextDecoder()['decode'](a['slice'](i+0x4,i+0x4+n)),m=i+0x4+n;break;case 0x3:const o=Array['from']({'length':0x8},(p,q)=>d['getUint16'](i+0x3+q*0x2)['toString'](0x10))['join'](':');l='['+o+']',m=i+0x13;break;default:return{'hasError':!![],'message':'Invalid\x20addressType:\x20'+k};}return{'hasError':![],'addressRemote':l,'portRemote':j,'rawDataIndex':m,'ProtocolVersion':new Uint8Array([e]),'isUDP':h===0x2};}async function handleNetworkInfo(a,b){const c=a['headers']['get']('CF-Connecting-IP'),d=b['proxyIP'],e=async k=>{if(!k)return null;try{const l=await fetch('https://ipinfo.io/'+k+'/json');if(!l['ok'])throw new Error('ipinfo.io\x20status:\x20'+l['status']);const m=await l['json']();return{'ip':m['ip'],'city':m['city'],'country':m['country'],'isp':m['org']};}catch(n){return console['error']('Failed\x20to\x20fetch\x20details\x20for\x20IP\x20'+k+':',n),{'ip':k};}},f=async k=>{if(!k||!b['scamalytics']['apiKey']||!b['scamalytics']['username'])return null;try{const l=''+b['scamalytics']['baseUrl']+b['scamalytics']['username']+'/?key='+b['scamalytics']['apiKey']+'&ip='+k,m=await fetch(l);if(!m['ok'])throw new Error('Scamalytics\x20status:\x20'+m['status']);const n=await m['json']();return n['status']==='ok'?{'score':n['score'],'risk':n['risk']}:null;}catch(o){return console['error']('Failed\x20to\x20fetch\x20Scamalytics\x20for\x20IP\x20'+k+':',o),null;}},[g,h,i]=await Promise['all']([e(c),e(d),f(c)]),j={'client':{...g,'risk':i},'proxy':{'host':b['proxyAddress'],...h}};return new Response(JSON['stringify'](j),{'headers':{'Content-Type':'application/json','Access-Control-Allow-Origin':'*'}});}function handleConfigPage(a,b,c){const d=generateBeautifulConfigPage(a,b,c);return new Response(d,{'headers':{'Content-Type':'text/html;\x20charset=utf-8'}});}function generateBeautifulConfigPage(a,b,c){const d=buildLink({'core':'xray','proto':'tls','userID':a,'hostName':b,'address':b,'port':0x1bb,'tag':b+'-Xray'}),e=buildLink({'core':'sb','proto':'tls','userID':a,'hostName':b,'address':b,'port':0x1bb,'tag':b+'-Singbox'}),f={'dream':d,'freedom':e},g='https://'+b+'/xray/'+a,h='https://'+b+'/sb/'+a,i='https://'+b+'/dns-query',j={'clashMeta':'clash://install-config?url='+encodeURIComponent('https://revil-sub.pages.dev/sub/clash-meta?url='+h+'&remote_config=&udp=false&ss_uot=false&show_host=false&forced_ws0rtt=true'),'hiddify':'hiddify://install-config?url='+encodeURIComponent(g),'v2rayng':'v2rayng://install-config?url='+encodeURIComponent(g),'exclave':'sn://subscription?url='+encodeURIComponent(h)};let k='\x0a\x20\x20\x20\x20<!doctype\x20html>\x0a\x20\x20\x20\x20<html\x20lang=\x22en\x22>\x0a\x20\x20\x20\x20<head>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<meta\x20charset=\x22UTF-8\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<meta\x20name=\x22viewport\x22\x20content=\x22width=device-width,\x20initial-scale=1.0\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<title>VLESS\x20Proxy\x20Configuration</title>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<link\x20rel=\x22icon\x22\x20href=\x22https://raw.githubusercontent.com/NiREvil/zizifn/refs/heads/Legacy/assets/favicon.png\x22\x20type=\x22image/png\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<link\x20rel=\x22preconnect\x22\x20href=\x22https://fonts.googleapis.com\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<link\x20rel=\x22preconnect\x22\x20href=\x22https://fonts.gstatic.com\x22\x20crossorigin>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<link\x20href=\x22https://fonts.googleapis.com/css2?family=Fira+Code:wght@300..700&display=swap\x22\x20rel=\x22stylesheet\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>'+getPageCSS()+'</style>\x0a\x20\x20\x20\x20</head>\x0a\x20\x20\x20\x20<body\x20data-proxy-ip=\x22'+c+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+getPageHTML(f,j,i)+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20<script>'+getPageScript()+'</script>\x0a\x20\x20\x20\x20</body>\x0a\x20\x20\x20\x20</html>';return k;}function getPageHTML(a,b,c){return'\x0a\x20\x20\x20\x20<div\x20class=\x22container\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>VLESS\x20Proxy\x20Configuration</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>Your\x20secure\x20connection\x20is\x20ready.\x20Follow\x20the\x20steps\x20below.</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22config-card\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22config-title\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>Step\x201:\x20Critical\x20DNS\x20Setup</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22card-description\x22>To\x20prevent\x20connection\x20errors,\x20copy\x20this\x20DNS\x20link\x20and\x20set\x20it\x20as\x20the\x20\x22Remote\x20DNS\x22\x20or\x20\x22DoH\x20URL\x22\x20in\x20your\x20VPN\x20app\x27s\x20settings.</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22config-content\x22><pre\x20id=\x22doh-url\x22>'+c+'</pre></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22button-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22button\x20client-btn\x22\x20onclick=\x22copyToClipboard(this,\x20\x27'+c+'\x27)\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22button-text\x22>Copy\x20DoH\x20Link</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22config-card\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22config-title\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>Step\x202:\x20Xray\x20Core\x20Clients</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22button\x20copy-buttons\x22\x20onclick=\x22copyToClipboard(this,\x20\x27'+a['dream']+'\x27)\x22>Copy</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22config-content\x22><pre>'+a['dream']+'</pre></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22client-buttons\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22'+b['hiddify']+'\x22\x20class=\x22button\x20client-btn\x22>Import\x20to\x20Hiddify</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22'+b['v2rayng']+'\x22\x20class=\x22button\x20client-btn\x22>Import\x20to\x20V2rayNG</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22config-card\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22config-title\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>Step\x202:\x20Sing-Box\x20Core\x20Clients</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22button\x20copy-buttons\x22\x20onclick=\x22copyToClipboard(this,\x20\x27'+a['freedom']+'\x27)\x22>Copy</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22config-content\x22><pre>'+a['freedom']+'</pre></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22client-buttons\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22'+b['clashMeta']+'\x22\x20class=\x22button\x20client-btn\x22>Import\x20to\x20Clash\x20Meta</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22'+b['exclave']+'\x22\x20class=\x22button\x20client-btn\x22>Import\x20to\x20Exclave</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22config-card\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22config-title\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>Network\x20Information</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22refresh-ip-info\x22\x20class=\x22refresh-btn\x22>Refresh</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22ip-info-grid\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22ip-info-section\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22ip-info-header\x22><h3>Proxy\x20Server</h3></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22ip-info-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22ip-info-item\x22><span\x20class=\x22label\x22>Host</span><span\x20class=\x22value\x22\x20id=\x22proxy-host\x22><span\x20class=\x22skeleton\x22></span></span></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22ip-info-item\x22><span\x20class=\x22label\x22>Location</span><span\x20class=\x22value\x22\x20id=\x22proxy-location\x22><span\x20class=\x22skeleton\x22></span></span></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22ip-info-item\x22><span\x20class=\x22label\x22>ISP</span><span\x20class=\x22value\x22\x20id=\x22proxy-isp\x22><span\x20class=\x22skeleton\x22></span></span></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22ip-info-section\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22ip-info-header\x22><h3>Your\x20Connection</h3></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22ip-info-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22ip-info-item\x22><span\x20class=\x22label\x22>IP</span><span\x20class=\x22value\x22\x20id=\x22client-ip\x22><span\x20class=\x22skeleton\x22></span></span></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22ip-info-item\x22><span\x20class=\x22label\x22>Location</span><span\x20class=\x22value\x22\x20id=\x22client-location\x22><span\x20class=\x22skeleton\x22></span></span></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22ip-info-item\x22><span\x20class=\x22label\x22>Risk\x20Score</span><span\x20class=\x22value\x22\x20id=\x22client-proxy\x22><span\x20class=\x22skeleton\x22></span></span></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>Â©\x20'+new Date()['getFullYear']()+'\x20REvil\x20-\x20All\x20Rights\x20Reserved</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20</div>';}const isValidUUID=a=>/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i['test'](a);async function isValidUser(a,b,c){if(!isValidUUID(a))return![];const d='user:'+a,f=await b['KV']['get'](d);if(f==='valid')return!![];if(f==='invalid')return![];try{const g=Math['floor'](Date['now']()/0x3e8),h=b['DB']['prepare']('SELECT\x20expiration_timestamp,\x20status\x20FROM\x20users\x20WHERE\x20id\x20=\x20?'),i=await h['bind'](a)['first']();if(!i||i['expiration_timestamp']<g||i['status']!=='active')return await b['KV']['put'](d,'invalid',{'expirationTtl':0xe10}),![];return c['waitUntil'](b['DB']['prepare']('UPDATE\x20users\x20SET\x20last_accessed\x20=\x20?\x20WHERE\x20id\x20=\x20?')['bind'](g,a)['run']()),await b['KV']['put'](d,'valid',{'expiration':i['expiration_timestamp']}),!![];}catch(j){return console['error']('D1\x20query\x20failed\x20in\x20isValidUser:',j),![];}}function makeReadableWebSocketStream(a,b,c){let d=![];return new ReadableStream({'start'(e){a['addEventListener']('message',h=>{if(d)return;e['enqueue'](h['data']);}),a['addEventListener']('close',()=>{if(d)return;e['close']();}),a['addEventListener']('error',h=>{if(d)return;c('WebSocket\x20error',h),e['error'](h);});const {earlyData:f,error:g}=base64ToArrayBuffer(b);if(g)e['error'](g);else f&&e['enqueue'](f);},'pull'(){},'cancel'(e){c('ReadableStream\x20cancelled',e),d=!![],safeCloseWebSocket(a);}});}function safeCloseWebSocket(a,b,c){try{(a['readyState']===CONST['WS_READY_STATE_OPEN']||a['readyState']===CONST['WS_READY_STATE_CLOSING'])&&a['close'](b,c);}catch(d){console['error']('safeCloseWebSocket\x20error:',d);}}const byteToHex=Array['from']({'length':0x100},(a,b)=>(b+0x100)['toString'](0x10)['slice'](0x1));function stringify(a){const b=(byteToHex[a[0x0]]+byteToHex[a[0x1]]+byteToHex[a[0x2]]+byteToHex[a[0x3]]+'-'+byteToHex[a[0x4]]+byteToHex[a[0x5]]+'-'+byteToHex[a[0x6]]+byteToHex[a[0x7]]+'-'+byteToHex[a[0x8]]+byteToHex[a[0x9]]+'-'+byteToHex[a[0xa]]+byteToHex[a[0xb]]+byteToHex[a[0xc]]+byteToHex[a[0xd]]+byteToHex[a[0xe]]+byteToHex[a[0xf]])['toLowerCase']();if(!isValidUUID(b))throw new TypeError('Invalid\x20UUID');return b;}function base64ToArrayBuffer(a){if(!a)return{'earlyData':null,'error':null};try{const b=atob(a['replace'](/-/g,'+')['replace'](/_/g,'/')),c=new ArrayBuffer(b['length']),d=new Uint8Array(c);for(let e=0x0;e<b['length'];e++)d[e]=b['charCodeAt'](e);return{'earlyData':c,'error':null};}catch(f){return{'earlyData':null,'error':f};}}function generateRandomPath(a=0xc,b=''){const c='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';let d='';for(let e=0x0;e<a;e++){d+=c['charAt'](Math['floor'](Math['random']()*c['length']));}return'/'+d+(b?'?'+b:'');}const CORE_PRESETS={'xray':{'tls':{'path':()=>generateRandomPath(0xc,'ed=2048'),'security':'tls','fp':'chrome','alpn':'http/1.1','extra':{}},'tcp':{'path':()=>generateRandomPath(0xc,'ed=2048'),'security':'none','fp':'chrome','extra':{}}},'sb':{'tls':{'path':()=>generateRandomPath(0x12),'security':'tls','fp':'firefox','alpn':'h3','extra':{'ed':0xa00}},'tcp':{'path':()=>generateRandomPath(0x12),'security':'none','fp':'firefox','extra':{'ed':0xa00}}}};function makeName(a,b){return a+'-'+b['toUpperCase']();}function createVlessLink({userID:a,address:b,port:c,host:d,path:e,security:f,sni:g,fp:h,alpn:i,extra:extra={},name:j}){const l=new URLSearchParams({'type':'ws','host':d,'path':e});if(f)l['set']('security',f);if(g)l['set']('sni',g);if(h)l['set']('fp',h);if(i)l['set']('alpn',i);for(const [m,n]of Object['entries'](extra))l['set'](m,n);return'vless://'+a+'@'+b+':'+c+'?'+l['toString']()+'#'+encodeURIComponent(j);}function buildLink({core:a,proto:b,userID:c,hostName:d,address:e,port:f,tag:g}){const h=CORE_PRESETS[a][b];return createVlessLink({'userID':c,'address':e,'port':f,'host':d,'path':h['path'](),'security':h['security'],'sni':h['security']==='tls'?d:undefined,'fp':h['fp'],'alpn':h['alpn'],'extra':h['extra'],'name':makeName(g,b)});}const pick=a=>a[Math['floor'](Math['random']()*a['length'])];async function handleIpSubscription(a,b,c){const d=[c,'creativecommons.org','www.speedtest.net','sky.rethinkdns.com','cf.090227.xyz','cdnjs.com','zula.ir','cfip.1323123.xyz','go.inmobi.com','singapore.com','www.visa.com'],f=[0x1bb,0x20fb,0x805,0x823,0x827,0x830],g=[0x50,0x1f90,0x22b0,0x804,0x822,0x826,0x82f];let h=[];const i=c['endsWith']('.pages.dev');d['forEach']((j,k)=>{h['push'](buildLink({'core':a,'proto':'tls','userID':b,'hostName':c,'address':j,'port':pick(f),'tag':'D'+(k+0x1)})),!i&&h['push'](buildLink({'core':a,'proto':'tcp','userID':b,'hostName':c,'address':j,'port':pick(g),'tag':'D'+(k+0x1)}));});try{const j=await fetch('https://raw.githubusercontent.com/NiREvil/vless/refs/heads/main/Cloudflare-IPs.json');if(j['ok']){const k=await j['json'](),l=[...k['ipv4']||[],...k['ipv6']||[]]['slice'](0x0,0x14)['map'](m=>m['ip']);l['forEach']((m,n)=>{const o=m['includes'](':')?'['+m+']':m;h['push'](buildLink({'core':a,'proto':'tls','userID':b,'hostName':c,'address':o,'port':pick(f),'tag':'IP'+(n+0x1)})),!i&&h['push'](buildLink({'core':a,'proto':'tcp','userID':b,'hostName':c,'address':o,'port':pick(g),'tag':'IP'+(n+0x1)}));});}}catch(m){console['error']('Failed\x20to\x20fetch\x20IP\x20list:',m);}return new Response(btoa(h['join']('\x0a')),{'headers':{'Content-Type':'text/plain;charset=utf-8'}});}async function handleAdminRoutes(a,b){const c=new URL(a['url']),d=c['pathname']['replace']('/admin','');if(a['method']==='GET'&&(d==='/login'||d==='/'))return new Response(getAdminLoginHTML(),{'headers':{'Content-Type':'text/html;\x20charset=utf-8'}});if(a['method']==='GET'&&d==='/dashboard')return new Response(getAdminDashboardHTML(),{'headers':{'Content-Type':'text/html;\x20charset=utf-8'}});const f=a['headers']['get']('Authorization');if(f!==b['ADMIN_KEY'])return Response['json']({'error':'Unauthorized'},{'status':0x191});try{if(a['method']==='POST'&&d==='/api/users'){const g=await a['json'](),{id:h,expiration_date:i,expiration_time:j,notes:notes=''}=g;if(!h||!i||!j||!isValidUUID(h))return Response['json']({'error':'Missing\x20or\x20invalid\x20parameters'},{'status':0x190});const k=Math['floor'](new Date(i+'T'+j+':00Z')['getTime']()/0x3e8),l=Math['floor'](Date['now']()/0x3e8);return await b['DB']['prepare']('INSERT\x20INTO\x20users\x20(id,\x20expiration_timestamp,\x20created_at,\x20last_accessed,\x20status,\x20notes,\x20admin_key)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?)')['bind'](h,k,l,l,'active',notes||null,f)['run'](),await b['KV']['delete']('user:'+h),Response['json']({'success':!![]});}if(a['method']==='GET'&&d==='/api/users'){const {results:m}=await b['DB']['prepare']('SELECT\x20*\x20FROM\x20users\x20ORDER\x20BY\x20created_at\x20DESC')['all']();return Response['json'](m);}if(a['method']==='DELETE'&&d['startsWith']('/api/users/')){const n=d['substring']('/api/users/'['length']);if(!isValidUUID(n))return Response['json']({'error':'Invalid\x20UUID\x20format'},{'status':0x190});return await b['DB']['prepare']('DELETE\x20FROM\x20users\x20WHERE\x20id\x20=\x20?')['bind'](n)['run'](),await b['KV']['delete']('user:'+n),Response['json']({'success':!![]});}}catch(o){return console['error']('Admin\x20API\x20Error:',o),Response['json']({'error':'An\x20internal\x20server\x20error\x20occurred:\x20'+o['message']},{'status':0x1f4});}return new Response('Admin\x20endpoint\x20not\x20found',{'status':0x194});}function getAdminLoginHTML(){return'<!DOCTYPE\x20html><html><head><title>Admin\x20Login</title><style>body{display:flex;justify-content:center;align-items:center;height:100vh;background:#1a1a1a;font-family:sans-serif;margin:0;}div{padding:2rem;background:#2a2a2a;border-radius:8px;color:white;text-align:center;}input,button{width:100%;padding:10px;margin-top:10px;border-radius:5px;border:1px\x20solid\x20#444;background:#333;color:white;box-sizing:border-box;}button{cursor:pointer;background:#007bff;}p{color:red;}</style></head><body><div><h2>Admin\x20Login</h2><input\x20type=\x22password\x22\x20id=\x22admin-key\x22\x20placeholder=\x22Enter\x20Admin\x20Key\x22><button\x20onclick=\x22login()\x22>Login</button><p\x20id=\x22error-message\x22></p></div><script>\x0a\x20\x20\x20\x20async\x20function\x20login()\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20const\x20key\x20=\x20document.getElementById(\x27admin-key\x27).value;\x0a\x20\x20\x20\x20\x20\x20\x20\x20const\x20errorP\x20=\x20document.getElementById(\x27error-message\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20errorP.textContent\x20=\x20\x27\x27;\x0a\x20\x20\x20\x20\x20\x20\x20\x20if\x20(!key)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20errorP.textContent\x20=\x20\x27Key\x20cannot\x20be\x20empty.\x27;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20return;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20try\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20const\x20response\x20=\x20await\x20fetch(\x27/admin/api/users\x27,\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20headers:\x20{\x20\x27Authorization\x27:\x20key\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20});\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20if\x20(response.ok)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20localStorage.setItem(\x27admin_key\x27,\x20key);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20window.location.href\x20=\x20\x27/admin/dashboard\x27;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x20else\x20if\x20(response.status\x20===\x20401)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20errorP.textContent\x20=\x20\x27Invalid\x20Key.\x20Access\x20Denied.\x27;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20errorP.textContent\x20=\x20\x27An\x20unknown\x20error\x20occurred.\x27;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x20catch\x20(err)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20errorP.textContent\x20=\x20\x27Failed\x20to\x20connect\x20to\x20the\x20server.\x27;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20document.getElementById(\x27admin-key\x27).addEventListener(\x27keyup\x27,\x20(event)\x20=>\x20{\x20if\x20(event.key\x20===\x20\x27Enter\x27)\x20login();\x20});\x0a\x20\x20</script></body></html>';}function getAdminDashboardHTML(){return'<!DOCTYPE\x20html><html\x20lang=\x22en\x22><head><meta\x20charset=\x22UTF-8\x22><meta\x20name=\x22viewport\x22\x20content=\x22width=device-width,\x20initial-scale=1.0\x22><title>Admin\x20Dashboard</title><style>body{background:#1a1a1a;font-family:sans-serif;color:#fff;padding:20px;}.dashboard{max-width:900px;margin:auto;background:#2a2a2a;border-radius:15px;padding:20px;}h1,h2{text-align:center;}.create-section{background:#333;padding:15px;border-radius:10px;margin-bottom:20px;}input,button{padding:8px;margin:5px;border:none;border-radius:5px;background:#444;color:#fff;}button{background:#007bff;cursor:pointer;}table{width:100%;border-collapse:collapse;}th,td{padding:10px;text-align:left;border-bottom:1px\x20solid\x20#444;word-break:break-all;}.expired{color:#ff5252;}</style></head><body><div\x20class=\x22dashboard\x22><h1>Admin\x20Dashboard</h1><div\x20class=\x22create-section\x22><h2>Create\x20User</h2><input\x20type=\x22text\x22\x20id=\x22new-id\x22\x20placeholder=\x22User\x20ID\x20(UUID)\x22><button\x20onclick=\x22generateUUID()\x22>Generate</button><input\x20type=\x22date\x22\x20id=\x22exp-date\x22><input\x20type=\x22time\x22\x20id=\x22exp-time\x22><input\x20type=\x22text\x22\x20id=\x22notes\x22\x20placeholder=\x22Notes\x22><button\x20onclick=\x22createUser()\x22>Create</button></div><div\x20class=\x22user-list\x22><h2>User\x20List</h2><table\x20id=\x22user-table\x22><thead><tr><th>ID</th><th>Expiry</th><th>Created</th><th>Status</th><th>Notes</th><th>Actions</th></tr></thead><tbody></tbody></table></div></div><script>\x0a\x20\x20\x20\x20const\x20adminKey\x20=\x20localStorage.getItem(\x27admin_key\x27);\x0a\x20\x20\x20\x20if\x20(!adminKey)\x20window.location.href\x20=\x20\x27/admin/login\x27;\x0a\x20\x20\x20\x20const\x20apiHeaders\x20=\x20{\x20\x27Content-Type\x27:\x20\x27application/json\x27,\x20\x27Authorization\x27:\x20adminKey\x20};\x0a\x20\x20\x20\x20async\x20function\x20apiFetch(endpoint,\x20options={}){const\x20res=await\x20fetch(\x27/admin/api\x27+endpoint,{...options,headers:apiHeaders});if(res.status===401){alert(\x27Unauthorized!\x27);window.location.href=\x27/admin/login\x27;}return\x20res;}\x0a\x20\x20\x20\x20function\x20generateUUID(){document.getElementById(\x27new-id\x27).value=crypto.randomUUID();}\x0a\x20\x20\x20\x20async\x20function\x20createUser(){const\x20id=document.getElementById(\x27new-id\x27).value;const\x20date=document.getElementById(\x27exp-date\x27).value;const\x20time=document.getElementById(\x27exp-time\x27).value;const\x20notes=document.getElementById(\x27notes\x27).value;if(!id||!date||!time)return\x20alert(\x27Fill\x20required\x20fields.\x27);const\x20res=await\x20apiFetch(\x27/users\x27,{method:\x27POST\x27,body:JSON.stringify({id,expiration_date:date,expiration_time:time,notes})});if(res.ok){alert(\x27User\x20created!\x27);loadUsers();}else{alert(\x27Error\x20creating\x20user.\x27);}}\x0a\x20\x20\x20\x20async\x20function\x20loadUsers(){const\x20res=await\x20apiFetch(\x27/users\x27);const\x20users=await\x20res.json();const\x20tbody=document.getElementById(\x27user-table\x27).querySelector(\x27tbody\x27);tbody.innerHTML=\x27\x27;const\x20now=Date.now()/1000;users.forEach(u=>{const\x20expiry=new\x20Date(u.expiration_timestamp*1000).toLocaleString();const\x20created=new\x20Date(u.created_at*1000).toLocaleDateString();const\x20statusClass=u.expiration_timestamp>now&&u.status===\x27active\x27?\x27\x27:\x27expired\x27;tbody.innerHTML+=`<tr><td>${u.id}</td><td\x20class=\x22${statusClass}\x22>${expiry}</td><td>${created}</td><td\x20class=\x22${statusClass}\x22>${u.status}</td><td>${u.notes||\x27\x27}</td><td><button\x20onclick=\x22deleteUser(\x27${u.id}\x27)\x22>Delete</button></td></tr>`;});}\x0a\x20\x20\x20\x20async\x20function\x20deleteUser(id){if(!confirm(\x27Delete\x20user?\x27))return;const\x20res=await\x20apiFetch(`/users/${id}`,{method:\x27DELETE\x27});if(res.ok){alert(\x27User\x20deleted!\x27);loadUsers();}else{alert(\x27Error\x20deleting\x20user.\x27);}}\x0a\x20\x20\x20\x20window.onload=()=>{generateUUID();loadUsers();};\x0a\x20\x20</script></body></html>';}function getPageCSS(){return'\x0a\x20\x20\x20\x20\x20\x20*\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20margin:\x200;\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x200;\x0a\x20\x20\x20\x20\x20\x20\x20\x20box-sizing:\x20border-box;\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20:root\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20--background-primary:\x20#1a1a1a;\x20--background-secondary:\x20#2a2a2a;\x20--background-tertiary:\x20#333;\x0a\x20\x20\x20\x20\x20\x20\x20\x20--border-color:\x20#444;\x20--border-color-hover:\x20#555;\x20--text-primary:\x20#e0e0e0;\x20--text-secondary:\x20#9e9e9e;\x0a\x20\x20\x20\x20\x20\x20\x20\x20--text-accent:\x20#ffffff;\x20--accent-primary:\x20#007bff;\x20--accent-secondary:\x20#3391ff;\x0a\x20\x20\x20\x20\x20\x20\x20\x20--shadow-color:\x20rgba(0,\x200,\x200,\x200.35);\x20--shadow-color-accent:\x20rgba(0,\x20123,\x20255,\x200.4);\x0a\x20\x20\x20\x20\x20\x20\x20\x20--border-radius:\x208px;\x20--transition-speed:\x200.2s;\x0a\x20\x20\x20\x20\x20\x20\x20\x20--status-success:\x20#70b570;\x20--status-error:\x20#e05d44;\x20--status-warning:\x20#e0bc44;\x0a\x20\x20\x20\x20\x20\x20\x20\x20--sans-serif:\x20-apple-system,\x20BlinkMacSystemFont,\x20\x22Segoe\x20UI\x22,\x20Helvetica,\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20--mono-serif:\x20\x22Fira\x20Code\x22,\x20monospace;\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20var(--sans-serif);\x20font-size:\x2016px;\x20background-color:\x20var(--background-primary);\x20color:\x20var(--text-primary);\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x202rem;\x20line-height:\x201.6;\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20.container\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20max-width:\x20800px;\x20margin:\x2020px\x20auto;\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20.header\x20{\x20text-align:\x20center;\x20margin-bottom:\x2040px;\x20}\x0a\x20\x20\x20\x20\x20\x20.header\x20h1\x20{\x20font-size:\x202.2rem;\x20color:\x20var(--text-accent);\x20margin-bottom:\x208px;\x20}\x0a\x20\x20\x20\x20\x20\x20.header\x20p\x20{\x20color:\x20var(--text-secondary);\x20font-size:\x201rem;\x20}\x0a\x20\x20\x20\x20\x20\x20.config-card\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20background:\x20var(--background-secondary);\x20border-radius:\x20var(--border-radius);\x20padding:\x2024px;\x20margin-bottom:\x2024px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20var(--border-color);\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20.config-title\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x201.5rem;\x20font-weight:\x20600;\x20color:\x20var(--accent-secondary);\x0a\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2016px;\x20padding-bottom:\x2016px;\x20border-bottom:\x201px\x20solid\x20var(--border-color);\x0a\x20\x20\x20\x20\x20\x20\x20\x20display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20space-between;\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20.card-description\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20color:\x20var(--text-secondary);\x0a\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2016px;\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20.config-content\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20background:\x20var(--background-tertiary);\x20border-radius:\x20var(--border-radius);\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2016px;\x20margin-bottom:\x2020px;\x20border:\x201px\x20solid\x20var(--border-color);\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20.config-content\x20pre\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x20font-family:\x20var(--mono-serif);\x20font-size:\x200.8rem;\x20color:\x20var(--text-primary);\x0a\x20\x20\x20\x20\x20\x20\x20\x20margin:\x200;\x20white-space:\x20pre-wrap;\x20word-break:\x20break-all;\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20.button-group\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20display:\x20flex;\x20justify-content:\x20flex-end;\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20.button\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20display:\x20inline-flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x20gap:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2010px\x2018px;\x20border-radius:\x20var(--border-radius);\x20font-size:\x201rem;\x20font-weight:\x20500;\x0a\x20\x20\x20\x20\x20\x20\x20\x20cursor:\x20pointer;\x20border:\x20none;\x20text-decoration:\x20none;\x0a\x20\x20\x20\x20\x20\x20\x20\x20transition:\x20background-color\x20var(--transition-speed)\x20ease,\x20transform\x20var(--transition-speed)\x20ease;\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20.copy-buttons\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20var(--background-tertiary);\x20color:\x20var(--text-primary);\x20border:\x201px\x20solid\x20var(--border-color);\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20.copy-buttons:hover\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#4d4d4d;\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20.client-buttons\x20{\x20display:\x20grid;\x20grid-template-columns:\x201fr\x201fr;\x20gap:\x2012px;\x20}\x0a\x20\x20\x20\x20\x20\x20.client-btn\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20background-color:\x20var(--accent-primary);\x20color:\x20var(--text-accent);\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20.client-btn:hover\x20{\x20background-color:\x20var(--accent-secondary);\x20}\x0a\x20\x20\x20\x20\x20\x20.button.copied\x20{\x20background-color:\x20var(--status-success)\x20!important;\x20color:\x20var(--text-accent)\x20!important;\x20}\x0a\x20\x20\x20\x20\x20\x20.footer\x20{\x20text-align:\x20center;\x20margin-top:\x2040px;\x20padding-bottom:\x2020px;\x20color:\x20var(--text-secondary);\x20font-size:\x200.8rem;\x20}\x0a\x20\x20\x20\x20\x20\x20.ip-info-grid\x20{\x20display:\x20grid;\x20grid-template-columns:\x20repeat(auto-fit,\x20minmax(250px,\x201fr));\x20gap:\x2024px;\x20}\x0a\x20\x20\x20\x20\x20\x20.ip-info-section\x20{\x20background-color:\x20var(--background-tertiary);\x20border-radius:\x20var(--border-radius);\x20padding:\x2016px;\x20}\x0a\x20\x20\x20\x20\x20\x20.ip-info-header\x20h3\x20{\x20font-size:\x201.1rem;\x20color:\x20var(--accent-secondary);\x20margin:\x200\x200\x2012px\x200;\x20padding-bottom:\x208px;\x20border-bottom:\x201px\x20solid\x20var(--border-color);\x20}\x0a\x20\x20\x20\x20\x20\x20.ip-info-item\x20{\x20display:\x20flex;\x20justify-content:\x20space-between;\x20margin-bottom:\x208px;\x20}\x0a\x20\x20\x20\x20\x20\x20.ip-info-item\x20.label\x20{\x20color:\x20var(--text-secondary);\x20}\x0a\x20\x20\x20\x20\x20\x20.ip-info-item\x20.value\x20{\x20color:\x20var(--text-primary);\x20word-break:\x20break-all;\x20}\x0a\x20\x20\x20\x20\x20\x20.skeleton\x20{\x20display:\x20inline-block;\x20background:\x20linear-gradient(90deg,\x20var(--background-tertiary)\x2025%,\x20#4d4d4d\x2050%,\x20var(--background-tertiary)\x2075%);\x20background-size:\x20200%\x20100%;\x20animation:\x20loading\x201.5s\x20infinite;\x20border-radius:\x204px;\x20height:\x2016px;\x20width:\x20120px;\x20}\x0a\x20\x20\x20\x20\x20\x20@keyframes\x20loading\x20{\x200%\x20{\x20background-position:\x20200%\x200;\x20}\x20100%\x20{\x20background-position:\x20-200%\x200;\x20}\x20}\x0a\x20\x20\x20\x20\x20\x20.refresh-btn\x20{\x20background-color:\x20transparent;\x20border:\x201px\x20solid\x20var(--border-color);\x20color:\x20var(--text-primary);\x20padding:\x206px\x2012px;\x20font-size:\x200.9rem;\x20}\x0a\x20\x20\x20';}function getPageScript(){return'\x0a\x20\x20\x20\x20\x20\x20function\x20copyToClipboard(button,\x20text)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20const\x20originalHTML\x20=\x20button.innerHTML;\x0a\x20\x20\x20\x20\x20\x20\x20\x20navigator.clipboard.writeText(text).then(()\x20=>\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20button.innerHTML\x20=\x20\x27Copied!\x27;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20button.classList.add(\x22copied\x22);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20setTimeout(()\x20=>\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20button.innerHTML\x20=\x20originalHTML;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20button.classList.remove(\x22copied\x22);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20},\x201500);\x0a\x20\x20\x20\x20\x20\x20\x20\x20}).catch(err\x20=>\x20console.error(\x22Failed\x20to\x20copy\x20text:\x20\x22,\x20err));\x0a\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20function\x20updateDisplay(data)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20const\x20setContent\x20=\x20(id,\x20value)\x20=>\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20const\x20el\x20=\x20document.getElementById(id);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20if\x20(el)\x20el.innerHTML\x20=\x20value\x20||\x20\x27N/A\x27;\x0a\x20\x20\x20\x20\x20\x20\x20\x20};\x0a\x20\x20\x20\x20\x20\x20\x20\x20setContent(\x27proxy-host\x27,\x20data.proxy?.host);\x0a\x20\x20\x20\x20\x20\x20\x20\x20setContent(\x27proxy-location\x27,\x20[data.proxy?.city,\x20data.proxy?.country].filter(Boolean).join(\x27,\x20\x27));\x0a\x20\x20\x20\x20\x20\x20\x20\x20setContent(\x27proxy-isp\x27,\x20data.proxy?.isp);\x0a\x20\x20\x20\x20\x20\x20\x20\x20setContent(\x27client-ip\x27,\x20data.client?.ip);\x0a\x20\x20\x20\x20\x20\x20\x20\x20setContent(\x27client-location\x27,\x20[data.client?.city,\x20data.client?.country].filter(Boolean).join(\x27,\x20\x27));\x0a\x20\x20\x20\x20\x20\x20\x20\x20let\x20riskText\x20=\x20\x27Unknown\x27;\x0a\x20\x20\x20\x20\x20\x20\x20\x20if\x20(data.client?.risk?.score\x20!==\x20undefined)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20riskText\x20=\x20`${data.client.risk.score}\x20-\x20${data.client.risk.risk}`;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20setContent(\x27client-proxy\x27,\x20riskText);\x0a\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20async\x20function\x20loadNetworkInfo()\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20try\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20const\x20response\x20=\x20await\x20fetch(\x27/api/network-info\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20if\x20(!response.ok)\x20throw\x20new\x20Error(\x27API\x20request\x20failed\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20const\x20data\x20=\x20await\x20response.json();\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20updateDisplay(data);\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x20catch\x20(error)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20console.error(\x27Failed\x20to\x20load\x20network\x20info:\x27,\x20error);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20updateDisplay({\x20client:\x20{},\x20proxy:\x20{\x20host:\x20document.body.getAttribute(\x27data-proxy-ip\x27)\x20}\x20});\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20document.getElementById(\x27refresh-ip-info\x27)?.addEventListener(\x27click\x27,\x20function()\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20const\x20elements\x20=\x20document.querySelectorAll(\x27.ip-info-item\x20.value\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20elements.forEach(el\x20=>\x20el.innerHTML\x20=\x20\x27<span\x20class=\x22skeleton\x22></span>\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20loadNetworkInfo();\x0a\x20\x20\x20\x20\x20\x20});\x0a\x0a\x20\x20\x20\x20\x20\x20document.addEventListener(\x27DOMContentLoaded\x27,\x20loadNetworkInfo);\x0a\x20\x20';}